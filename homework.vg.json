{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": 800,
    "height": 400,
    "title": "Quality of Coffee in Countries working with the CQI as of May 2023",
    "projection": {"type": "equalEarth"},
    "data": {
      "url": "https://raw.githubusercontent.com/andrewooi924/andrewooi924.github.io/main/data/ne_110m.json",
      "format": {"type": "topojson", "feature": "ne_110m_admin_0_countries"}},
    "layer": [
      {
        "data": {"sphere": true},
        "mark": {"type": "geoshape", "fill": "lightskyblue"}
      },
      {
        "data": {
          "url": "https://raw.githubusercontent.com/andrewooi924/andrewooi924.github.io/main/data/ne_110m.json",
          "format": {"type": "topojson", "feature": "ne_110m_graticules_30"}
        },
        "mark": {"type": "geoshape", "fill": null, "stroke": "gray"}
      },
      {
        "transform": [
          {"calculate": "'No data regarding manufacture of coffee in ' + datum.properties.NAME", "as": "note"}
        ],
        "mark": {"type": "geoshape", "fill": "lightgray", "stroke": "white"},
        "encoding": {
          "tooltip": {
            "field": "note"
          }
        }
      },
      {
        "transform": [
            {
              "lookup": "properties.NAME",
              "from": {
                "data": {
                  "url": "https://raw.githubusercontent.com/andrewooi924/andrewooi924.github.io/main/data/df_arabica_clean.csv"
                },
                "key": "Country of Origin",
                "fields": ["Acidity", "Aftertaste", "Aroma", "Balance", "Body", "Clean Cup", "Flavor", "Sweetness", "Uniformity", "Total Cup Points"]
              }
            },
            {
              "calculate": "datum['Total Cup Points']", "as": "Average Score"
            }
          ],
        "mark": {"type": "geoshape", "stroke": "white"},
        "encoding": {
          "color": {
            "field": "Average Score",
            "type": "quantitative"
          },
          "tooltip": [
            {"field": "properties.NAME", "type": "nominal", "title": "Country"},
            {"field": "Average Score", "type": "quantitative"},
            {"field": "Acidity", "type": "quantitative"},
            {"field": "Aftertaste", "type": "quantitative"},
            {"field": "Aroma", "type": "quantitative"},
            {"field": "Balance", "type": "quantitative"},
            {"field": "Body", "type": "quantitative"},
            {"field": "Clean Cup", "type": "quantitative"},
            {"field": "Flavor", "type": "quantitative"},
            {"field": "Sweetness", "type": "quantitative"},
            {"field": "Uniformity", "type": "quantitative"}
          ]
        }
      }
    ]
  }